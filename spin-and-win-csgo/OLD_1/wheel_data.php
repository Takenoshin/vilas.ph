<?php

$prizes = [
    'A40A00-0ACAAE2B-1CCC' => 'Prize 3',
    'A48A00-C9BDB808-9B61' => 'Prize 4',
    'A60A00-C2C92804-98A6' => 'Prize 5',
    'A370A0-9BE37CC7-E886' => 'Prize 6',
    'AABABA-8913023E-8F3A' => 'Prize 2',
    'A0C0C0-0B554DE8-3E3D' => 'Prize 1',
    'A0C0C0-0B554DE8-6969' => 'Prize 7',
    'A60000-CB15BBB8-A606' => 'TRY AGAIN',
];


$languagePrizes = [


    'A60000-CB15BBB8-A606' => [
        'text' => [
            'en' => 'TRY AGAIN',
            'id' => 'COBA LAGI',
            'th' => 'ลองอีกครั้ง',
            'vn' => 'THỬ LẠI',
            'cn' => '再试一次',
            'my-cn' => '再试一次',
            'jp' => 'TRY AGAIN',
            'kr' => 'TRY AGAIN',
            'in' => 'TRY AGAIN',
        ],
        'value' => [
            'en' => 'TRY AGAIN',
            'id' => 'COBA LAGI',
            'th' => 'ลองอีกครั้ง',
            'vn' => 'THỬ LẠI',
            'cn' => '再试一次',
            'my-cn' => '再试一次',
            'jp' => 'TRY AGAIN',
            'kr' => 'TRY AGAIN',
            'in' => 'TRY AGAIN',
        ],
        'prize' => 'na',
        'ui' => [
            'en' => [
                'type' =>  'string', 
                'value' =>  'TRY AGAIN',
            ],
            'id' => [
                'type' =>  'string', 
                'value' =>  'COBA LAGI',
            ],
            'th' => [
                'type' =>  'string', 
                'value' =>  'ลองอีกครั้ง',
            ],
            'vn' => [
                'type' =>  'string', 
                'value' =>  'THỬ LẠI',
            ],
            'cn' => [
                'type' =>  'string', 
                'value' =>  '再试一次',
            ],
            'my-cn' => [
                'type' =>  'string', 
                'value' =>  '再试一次',
            ],
            'jp' => [
                'type' =>  'string', 
                'value' =>  'TRY AGAIN',
            ],
            'kr' => [
                'type' =>  'string', 
                'value' =>  'TRY AGAIN',
            ],
            'in' => [
                'type' =>  'string', 
                'value' =>  'TRY AGAIN',
            ],
        ],
    ],

    //Prize #1
    'A0C0C0-0B554DE8-3E3D' => [
        'text' => [
            'en' => 'You won iPhone 14 Pro Max!',
            'id' => 'Anda memenangkan iPhone 14 Pro Max!',
            'th' => 'คุณชนะ iPhone 14 Pro Max',
            'vn' => 'Bạn thắng iPhone 14 Pro Max',
            'cn' => '获得了iPhone 14 Pro Max奖金',
            'my-cn' => '获得了iPhone 14 Pro Max奖金',
            'jp' => 'You won iPhone 14 Pro Max!',
            'kr' => 'You won iPhone 14 Pro Max!',
            'in' => 'You won iPhone 14 Pro Max!',
        ],
        'value' => [
            'en' => 'iPhone 14 Pro Max',
            'id' => 'iPhone 14 Pro Max',
            'th' => 'iPhone 14 Pro Max',
            'vn' => 'iPhone 14 Pro Max',
            'cn' => 'iPhone 14 Pro Max',
            'my-cn' => 'iPhone 14 Pro Max',
            'jp' => 'iPhone 14 Pro Max',
            'kr' => 'iPhone 14 Pro Max',
            'in' => 'iPhone 14 Pro Max',
        ],
        'prize' => 'na',
        'ui' => [
            'type' =>  'image', 
            'value' =>  'img/game/prize-1.png',
        ],
    ],

    //Prize #2
    'AABABA-8913023E-8F3A' => [
        'text' => [
            'en' => 'You won Samsung Galaxy S23 Ultra!',
            'id' => 'Anda memenangkan Samsung Galaxy S23 Ultra!',
            'th' => 'คุณชนะ Samsung Galaxy S23 Ultra',
            'vn' => 'Bạn thắng Samsung Galaxy S23 Ultra',
            'cn' => '获得了Samsung Galaxy S23 Ultra奖金',
            'my-cn' => '获得了Samsung Galaxy S23 Ultra奖金',
            'jp' => 'You won Samsung Galaxy S23 Ultra!',
            'kr' => 'You won Samsung Galaxy S23 Ultra!',
            'in' => 'You won Samsung Galaxy S23 Ultra!',
        ],
        'value' => [
            'en' => 'Samsung Galaxy S23 Ultra',
            'id' => 'Samsung Galaxy S23 Ultra',
            'in' => 'Samsung Galaxy S23 Ultra',
            'th' => 'Samsung Galaxy S23 Ultra',
            'vn' => 'Samsung Galaxy S23 Ultra',
            'cn' => 'Samsung Galaxy S23 Ultra',
            'my-cn' => 'Samsung Galaxy S23 Ultra',
            'kr' => 'Samsung Galaxy S23 Ultra',
            'jp' => 'Samsung Galaxy S23 Ultra',
        ],
        'prize' => 'na',
        'ui' => [
            'type' =>  'image', 
            'value' =>  'img/game/prize-2.png',
        ],
    ],

    //Prize #3
    'A40A00-0ACAAE2B-1CCC' => [
        'text' => [
            'en' => 'You won MYR80 Free Bet!',
            'in' => 'You won ₹1600 Free Bet!',
            'id' => 'Anda memenangkan IDR 280 Free Bet!',
            'th' => 'คุณได้รับรางวัล ฟรีเบท 640 บาท!',
            'vn' => 'Bạn đã thắng 460 VND Free Bet!',
            'cn' => '获得了免费下注 140 人民币奖金',
            'my-cn' => '获得了免费下注 80 马币奖金',
            'kr' => '프리벳 KRW 28,000당첨',
            'jp' => 'USD 20 フリーベットあなたの勝ちです。',
        ],
        'value' => [
            'en' => 'MYR80 Free Bet',
            'in' => '₹1600 Free Bet',
            'id' => 'IDR 280 Free Bet',
            'th' => 'ฟรีเบท 640 บาท',
            'vn' => '460 VND Free Bet',
            'cn' => '免费下注 140 人民币',
            'my-cn' => '免费下注 80 马币',
            'kr' => '프리벳 KRW 28,000',
            'jp' => 'USD 20 フリーベット',
        ],
        'prize' => 'p3',
        'ui' => [
            'type' =>  'image', 
            'value' =>  'img/game/prize-3.png',
        ],
    ],


    //Prize #4
    'A48A00-C9BDB808-9B61' => [
        'text' => [
            'en' => 'You won MYR20 Free Bet + $10 Steam Gift Card!',
            'in' => 'You won ₹400 Free Bet + $10 Steam Gift Card!',
            'id' => 'Anda memenangkan  IDR 70 Free Bet + $10 Steam Gift Card!',
            'vn' => 'Bạn thắng 115 VND Free Bet + Thẻ quà tặng $10 Steam!',
            'th' => 'คุณชนะ ฟรีเบท 160 บาท+ $10 Steam Gift Card!',
            'cn' => '获得了免费下注 30 人民币 + STEAM 10美金充值卡奖金',
            'my-cn' => '获得了免费下注 20 马币 + STEAM 10美金充值卡奖金',
            'kr' => '프리벳 KRW 7,000 + $10 스팀 기프트 카드에서 우승했습니다!',
            'jp' => 'USD 5フリーベット＋$10Steamギフトカードを獲得しました！',
        ],
        'value' => [
            'en' => 'MYR20 Free Bet + $10 Steam Gift Card',
            'in' => '₹400 Free Bet + 
            $10 Steam Gift Card',
            'id' => 'IDR 70 Free Bet + 
            $10 Steam Gift Card',
            'th' => 'ฟรีเบท 160 บาท+ 
            $10 Steam Gift Card',
            'vn' => '115 VND Free Bet + 
            Thẻ quà tặng $10 Steam',
            'cn' => '免费下注 30 人民币 + STEAM 10美金充值卡',
            'my-cn' => '免费下注 20 马币 + STEAM 10美金充值卡',
            'kr' => '프리벳 KRW 7,000 + 
            $10 스팀 기프트 카드',
            'jp' => 'USD 5フリーベット＋
            $10Steamギフトカード',
        ],
        'prize' => 'p4',
        'ui' => [
            'type' =>  'image', 
            'value' =>  'img/game/prize-4.png',
        ],

    ],

    //Prize #5
    'A60A00-C2C92804-98A6' => [
        'text' => [
            'en' => 'You won MYR20 Free Bet + 335CG Esports Jersey!',
            'in' => 'You won ₹400 Free Bet + 335CG Esports Jersey!',
            'id' => 'Anda memenangkan  IDR 70 Free Bet + 335CG Esports Jersey!',
            'vn' => 'Bạn thắng 115 VND Free Bet + Áo đấu 335CG Esports !',
            'th' => 'คุณชนะ ฟรีเบท 160 บาท+335CG Esports Jersey!',
            'cn' => '获得了免费下注 30 人民币 + 335CG 电竞队服奖金',
            'my-cn' => '获得了免费下注 20 马币 + 335CG 电竞队服奖金',
            'kr' => '프리벳 KRW 7,000 + 335CG E스포츠 저지에서 우승했습니다!',
            'jp' => 'USD 5フリーベット＋335CG eスポーツユニフォームを獲得しました！',
        ],
        'value' => [
            'en' => 'MYR20 Free Bet + 335CG Esports Jersey',
            'in' => '₹400 Free Bet + 335CG Esports Jersey',
            'id' => 'IDR 70 Free Bet + 335CG Esports Jersey',
            'th' => 'ฟรีเบท 160 บาท+335CG Esports Jersey',
            'vn' => '115 VND Free Bet + Áo đấu 335CG Esports',
            'cn' => '免费下注 30 人民币 + 335CG 电竞队服',
            'my-cn' => '免费下注 20 马币 + 335CG 电竞队服',
            'kr' => '프리벳 KRW 7,000 + 335CG E스포츠 저지',
            'jp' => 'USD 5フリーベット＋335CG eスポーツユニフォーム',
        ],
        'prize' => 'p5-5',
        'ui' => [
            'type' =>  'image', 
            'value' =>  'img/game/prize-5.png',
        ],
    ],

    //Prize #6
    'A370A0-9BE37CC7-E886' => [
        'text' => [
            'en' => 'You won MYR20 Free Bet + 50 M88 Esports Lottery Tickets!',
            'in' => 'You won ₹400 Free Bet + 50 M88 Esports Lottery Tickets!',
            'id' => 'Anda memenangkan  IDR 70 Free Bet + 50 M88 Esports Lottery Tickets!',
            'vn' => 'Bạn thắng 115 VND Free Bet + 50 M88 Vé số Thể thao điện tử!',
            'th' => 'คุณชนะ ฟรีเบท 160 บาท+ 50 M88 Esports Lottery Tickets!',
            'cn' => '获得了免费下注 30 人民币 + 50张 M88 电竞彩票奖金',
            'my-cn' => '获得了免费下注 20 马币 + 50张 M88 电竞彩票奖金',
            'kr' => '프리벳 KRW 7,000 + 50 M88 E스포츠 로또 티켓에서 우승했습니다!',
            'jp' => 'USD 5フリーベット＋50 M88 eスポーツ抽選チケットを獲得しました！',
        ],
        'value' => [
            'en' => 'MYR20 Free Bet + 50 M88 Esports Lottery Tickets',
            'in' => '₹400 Free Bet + 50 M88 Esports Lottery Tickets',
            'id' => 'IDR 70 Free Bet + 50 M88 Esports Lottery Tickets',
            'th' => 'ฟรีเบท 160 บาท+ 50 M88 Esports Lottery Tickets',
            'vn' => '115 VND Free Bet + 50 M88 Vé số Thể thao điện tử',
            'cn' => '免费下注 30 人民币 + 50张 M88 电竞彩票',
            'my-cn' => '免费下注 20 马币 + 50张 M88 电竞彩票',
            'kr' => '프리벳 KRW 7,000 + 50 M88 E스포츠 로또 티켓',
            'jp' => 'USD 5フリーベット＋50 M88 eスポーツ抽選チケット',
        ],
        'prize' => 'p6-5',
        'ui' => [
            'type' =>  'image', 
            'value' =>  'img/game/prize-6.png',
        ],
    ],


    //Prize #7
    'A0C0C0-0B554DE8-6969' => [
        'text' => [
            'en' => 'You won MYR20 Free Bet!',
            'in' => 'You won ₹400 Free Bet!',
            'id' => 'Anda memenangkan  IDR 70 Free Bet!',
            'vn' => 'Bạn thắng 115 VND Free Bet!',
            'th' => 'คุณชนะ ฟรีเบท 160 บาท!',
            'cn' => '获得了免费下注 30 人民币奖金',
            'my-cn' => '获得了免费下注 20 马币奖金',
            'kr' => '프리벳 KRW 7,000에서 우승했습니다!',
            'jp' => 'USD 5 フリーベットあなたの勝ちです。',
        ],
        'value' => [
            'en' => 'MYR20 Free Bet',
            'in' => '₹400 Free Bet',
            'id' => 'IDR 70 Free Bet',
            'th' => 'ฟรีเบท 160 บาท',
            'vn' => '115 VND Free Bet',
            'cn' => '免费下注 30 人民币',
            'my-cn' => '免费下注 20 马币',
            'kr' => '프리벳 KRW 7,000',
            'jp' => 'USD 5 フリーベット',
        ],
        'prize' => 'p7-5',
        'ui' => [
            'type' =>  'image', 
            'value' =>  'img/game/prize-7.png',
        ],
    ],


];


// global $prizes;
// $urlApi = 'https://softsolutions.pro/wp-json/spin-win/v2/probability';
// $ch = curl_init($urlApi);
// // curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 10);
// curl_setopt($ch, CURLOPT_TIMEOUT, 10);
// curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
// $response = curl_exec($ch);
// $prizes = json_decode($response, true);
// if(curl_errno($ch)){
    // use default as zero all try again 1...
    $prizes = [
        'A0C0C0-0B554DE8-3E3D' => 0, // 'Prize #1,
        'AABABA-8913023E-8F3A' => 0, // 'Prize #2',
        'A40A00-0ACAAE2B-1CCC' => 5, // 'Prize #3',
        'A48A00-C9BDB808-9B61' => 10, // 'Prize #4',
        'A60A00-C2C92804-98A6' => 5, // 'Prize #5',
        'A370A0-9BE37CC7-E886' => 25, // 'Prize #6',
        'A0C0C0-0B554DE8-6969' => 55, // 'Prize #7',
    ];
// }

function getProbability($uuid) {
    global $prizes;

    return $prizes[$uuid];
}

function get_prize($uuid) {

    global $languagePrizes, $language;

    // try again
    if ($uuid == 'A60000-CB15BBB8-A606') {
        if ($languagePrizes[$uuid]['ui'][$language]['type'] == 'image') {
            $prize = [
                'probability' => getProbability($uuid), 
                'type' =>  $languagePrizes[$uuid]['ui'][$language]['type'],
                'ftxt' =>  '',
                'value' =>  $languagePrizes[$uuid]['ui'][$language]['value'],
                'win' =>  false,
                'resultText' =>  '<div class="txt-1">'. $languagePrizes[$uuid]['text'][$language] .'</div>',
                'userData' => [
                  'prize_uuid' => $uuid,
                  'prize_name' => $languagePrizes[$uuid]['value'][$language],
                  'prize_tier' => $languagePrizes[$uuid]['prize'],
                ],
                'cclass' =>  'style1'
            ];
        } else {
            $prize = [
                'probability' => getProbability($uuid), 
                'type' =>  $languagePrizes[$uuid]['ui'][$language]['type'],
                'ftxt' =>  '',
                'value' =>  $languagePrizes[$uuid]['value'][$language],
                'win' =>  false,
                'resultText' =>  '<div class="txt-1">'. $languagePrizes[$uuid]['text'][$language] .'</div>',
                'userData' => [
                  'prize_uuid' => $uuid,
                  'prize_name' => $languagePrizes[$uuid]['value'][$language],
                  'prize_tier' => $languagePrizes[$uuid]['prize'],
                ],
                'trotate' =>  true
            ];
        }
    } elseif ($languagePrizes[$uuid]['ui']['type'] == 'image') {
        $prize = [
            'probability' => getProbability($uuid), 
            'type' =>  $languagePrizes[$uuid]['ui']['type'],
            'ftxt' =>  '',
            'value' =>  $languagePrizes[$uuid]['ui']['value'],
            'win' =>  true,
            'resultText' =>  '<div class="txt-2">'. $languagePrizes[$uuid]['text'][$language] .'</div>',
            'userData' => [
              'prize_uuid' => $uuid,
              'prize_name' => $languagePrizes[$uuid]['value'][$language],
              'prize_tier' => $languagePrizes[$uuid]['prize'],
            ],
            'trotate' =>  true,
            'cclass' =>  'style1'
        ];
    } else {
        $prize = [
            'probability' => getProbability($uuid), 
            'type' =>  $languagePrizes[$uuid]['ui']['type'],
            'ftxt' =>  '',
            'value' =>  $languagePrizes[$uuid]['value'][$language],
            'win' =>  true,
            'resultText' =>  '<div class="txt-2">'. $languagePrizes[$uuid]['text'][$language] .'</div>',
            'userData' => [
              'prize_uuid' => $uuid,
              'prize_name' => $languagePrizes[$uuid]['value'][$language],
              'prize_tier' => $languagePrizes[$uuid]['prize'],
            ],
            'trotate' =>  true
        ];
    }



    return $prize;
}



global $language;

header('Content-type: application/json');


$language = 'en';
if (!empty($_GET['lang']))
    $language = $_GET['lang'];


$spin1 = [
    'A0C0C0-0B554DE8-3E3D', // 'Prize #1,
    'AABABA-8913023E-8F3A', // 'Prize #2',
    'A40A00-0ACAAE2B-1CCC', // 'Prize #3',
    'A48A00-C9BDB808-9B61', // 'Prize #4',
    'A60A00-C2C92804-98A6', // 'Prize #5',
    'A370A0-9BE37CC7-E886', // 'Prize #6',
    'A0C0C0-0B554DE8-6969', // 'Prize #7',
];
    


foreach ($spin1 as $key) {
    $arrayPrize[] = get_prize($key);
}



$data = array(
"colorArray" => ["#333333","#331111", "#33270b", "#1d3609", "#192e2f", "#17243e", "#340d2c","#000000", "#ffffff", "#000000", "#ffffff", "#000000", "#ffffff","#000000", "#ffffff", "#000000"],


"segmentValuesArray" => $arrayPrize,


    "svgWidth" =>  1024,
    "svgHeight" =>  1024,
    "wheelStrokeColor" =>  "#D0BD0C",
    "wheelStrokeWidth" =>  0,
    "wheelSize" =>  900,
    "wheelTextOffsetY" =>  80,
    "wheelTextColor" =>  "#fff",  
    "wheelImageOffsetY" =>  38,
    "wheelImageSize" =>  410,
    "centerCircleSize" =>  360,
    "centerCircleStrokeColor" =>  "#F1DC15",
    "centerCircleStrokeWidth" =>  0,
    "centerCircleFillColor" =>  "#EDEDED",
    "centerCircleImageUrl" => "img/game/wheel-middle.svg",
    "centerCircleImageWidth" => 400,
    "centerCircleImageHeight" => 400,  
    "segmentStrokeColor" =>  "#E2E2E2",     
    "segmentStrokeWidth" =>  0,
    "centerX" =>  512,
    "centerY" =>  512,  
    "hasShadows" =>  false,


    "numSpins" =>  1,

    "spinDestinationArray" => [],


    "minSpinDuration" => 13,


    "gameOverText" => "CONGRATULATIONS!",
    "invalidSpinText" => "INVALID SPIN. PLEASE SPIN AGAIN.",
    "introText" => "YOU HAVE TO<br>SPIN IT <span style='color => #F282A9;'>2</span> WIN IT!",
    "hasSound" => true,
    "gameId" => $_GET['uuid'],
    "language" => $_GET['lang'],
    "clickToSpin" => true,
    "spinDirection" =>  "ccw" 
);



echo json_encode( $data, JSON_PRETTY_PRINT);



